% SDDS Toolkit manual entry for sddspvalogger
\begin{sddsprog}{sddspvalogger}
\item \textbf{description:}
\verb+sddspvalogger+ connects to process variables over the EPICS7 PVA and CA protocols and logs the values to an SDDS file. The program supports conditional logging, data strobes, generation-based file rotation, and optional glitch capture.
\item \textbf{examples:}
\begin{verbatim}
sddspvalogger pvlist.sdds data.sdds -sampleInterval=1,seconds -steps=10
\end{verbatim}
where {\tt pvlist.sdds} defines the PVs to monitor and {\tt data.sdds} receives the logged values.
\item \textbf{synopsis:}
\begin{verbatim}
usage: sddspvalogger <inputfile> <outputfile>
Global Options:
  [-pendIOtime=<value>]
  [-watchInput]
  [-monitorMode=[randomTimedTrigger]]
  [-append | -overwrite]
  [-sampleInterval=<real-value>[,<time-units>]]
  [-dataStrobePV=<PVname>,<provider>[,notTimeValue][,holdoff=<seconds>]]
  [-steps=<integer-value>]
  [-time=<real-value>[,<time-units>]]
  [-conditions=<filename>,{allMustPass|oneMustPass}[,touchOutput][,retakeStep]]
  [-onerror={usezero|skip|exit}]
  [-inhibitPV=name=<name>,provider=<provider>[,waitTime=<seconds>]]
  [-generations[=digits=<integer>][,delimiter=<string>][,rowlimit=<number>][,timelimit=<secs>]]
  [-dailyFiles[=rowlimit=<number>][,timelimit=<secs>][,timetag][,verbose]]
  [-monthlyFiles[=rowlimit=<number>][,timelimit=<secs>][,timetag][,verbose]]
  [-strictPVverification]
  [-truncateWaveforms]
  [-runControlPV=string=<string>,pingTimeout=<value>]
  [-runControlDescription=string=<string>]
  [-verbose]
Logger Options:
  [-logInterval=<integer-value>]
  [-flushInterval=<integer-value>]
  [-onePvPerFile=<dirName>]
Glitch Logger Options:
  [-triggerFile=<filename>]
  [-circularBuffer=[before=<number>,][after=<number>]]
  [-delay=<steps>] [NOT YET IMPLEMENTED]
  [-holdoffTime=<seconds>]
  [-autoHoldoff]
\end{verbatim}
\item \textbf{files:}
\begin{itemize}
  \item \textbf{input file:} SDDS file with string column \verb|ControlName| listing PVs to log.
  \item \textbf{output file:} SDDS file containing logged PV values.
\end{itemize}

\item \textbf{switches:}
\begin{itemize}
  \item {\tt -pendIOtime=<value>} --- maximum time to wait for PV responses.
  \item {\tt -watchInput} --- watches the input file and exits if it changes (including changes to a symlink target). If \verb|-triggerFile| is in use, the trigger file is also watched. This option does not reload files in-place; instead it is intended for use with an external supervisor script that restarts the logger when a change is detected. When used in conjunction with the run control feature, an automated script can be used to restart the logger cleanly.
  \item {\tt -monitorMode=[randomTimedTrigger]} --- use monitor mode; optional value randomizes trigger timing.
  \item {\tt -append} --- append to an existing output file.
  \item {\tt -overwrite} --- overwrite an existing output file.
  \item {\tt -sampleInterval=<real-value>[,<time-units>]} --- interval between readings.
  \item {\tt -dataStrobePV=<PVname>,<provider>[,notTimeValue][,holdoff=<seconds>]} --- use a PV as a data strobe with optional holdoff.
  \item {\tt -steps=<integer-value>} --- number of samples to take before exiting.
  \item {\tt -time=<real-value>[,<time-units>]} --- total logging time.
  \item {\tt -conditions=<file>,\{allMustPass|oneMustPass\}[,touchOutput][,retakeStep]} --- require limits from a conditions file.
  \item {\tt -onerror=\{usezero|skip|exit\}} --- action taken when a read fails.
  \item {\tt -inhibitPV=name=<name>,provider=<provider>[,waitTime=<seconds>]} --- inhibit logging while this PV is nonzero.
  \item {\tt -generations[=digits=<integer>][,delimiter=<string>][,rowlimit=<number>][,timelimit=<secs>]} --- rotate output files by generation.
  \item {\tt -dailyFiles[=rowlimit=<number>][,timelimit=<secs>][,timetag][,verbose]} --- start a new output file each day.
  \item {\tt -monthlyFiles[=rowlimit=<number>][,timelimit=<secs>][,timetag][,verbose]} --- start a new output file each month.
  \item {\tt -strictPVverification} --- exit if PV data do not match expectations.
  \item {\tt -truncateWaveforms} --- truncate waveform PVs to the minimum common length.
  \item {\tt -runControlPV=string=<pv>,pingTimeout=<value>} --- integrate with run control.
  \item {\tt -runControlDescription=string=<string>} --- description for the run-control record.
  \item {\tt -verbose} --- print progress messages.
  \item {\tt -logInterval=<integer-value>} --- average this many samples before writing.
  \item {\tt -flushInterval=<integer-value>} --- force a file flush after this many samples.
  \item {\tt -onePvPerFile=<dirName>} --- write each PV to a separate file in the given directory.
  \item {\tt -triggerFile=<filename>} --- read glitch trigger definitions from an SDDS file.
  \item {\tt -circularBuffer=[before=<number>,][after=<number>]} --- samples to retain before and after a trigger.
  \item {\tt -delay=<steps>} --- delay reading after a trigger (not yet implemented).
  \item {\tt -holdoffTime=<seconds>} --- minimum time between triggers.
  \item {\tt -autoHoldoff} --- compute holdoff time from post-trigger samples.
\end{itemize}

\item \textbf{see also:}
\begin{itemize}
  \item \progref{sddslogger}
  \item \progref{sddsglitchlogger}
  \item \progref{sddspvtest}
\end{itemize}
\item \textbf{author:} Robert Soliday, Hairong Shang, ANL/APS.
\end{sddsprog}
