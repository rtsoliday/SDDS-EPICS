% sddspvacontrollaw: perform PV Access feedback using an inverse response matrix.
%
\begin{sddsprog}{sddspvacontrollaw}
\item \textbf{description:}
\verb+sddspvacontrollaw+ performs feedback on process variables using PV Access. The
input file defines an inverse response matrix: each column names a readback PV and a
string column lists the actuator PVs. The program adjusts actuators to regulate the
readbacks to zero or to given offsets, optionally logging data and applying limits.

\item \textbf{examples:}
\begin{verbatim}
sddspvacontrollaw sddspvacontrollaw.inv -searchPath=/home/controls -interval=1 -steps=10 -gain=0.75 -runControlPV=string=shang:ControlLawRC -verbose
\end{verbatim}

\item \textbf{synopsis:}
\begin{verbatim}
usage: sddspvacontrollaw <inputfile> [-searchPath=<dir-path>] [-actuatorColumn=<string>] [<outputfile>]
[-gain={<real-value>|PVname=<name>}] [-interval={<real-value>|PVname=<name>}] [-steps=<integer>]
[-updateInterval=<integer>] [-average={<number>|PVname=<name>}[,interval=<seconds>]]
[-testValues=<file>]
[-despike[=neighbors=<integer>][,passes=<integer>][,averageOf=<integer>][,threshold=<value>][,pvthreshold=<pvname>][,file=<filename>][,countLimit=<integer>][,startThreshold=<value>,endThreshold=<value>,stepsThreshold=<integer>][,rampThresholdPV=<string>]]
[-deltaLimit={value=<value>|file=<filename>}]
[-readbackLimit={value=<value>|minValue=<value>,maxValue=<value>|file=<filename>}]
[-actionLimit={value=<value>|file=<filename>}]
[-runControlPV={string=<string>|parameter=<string>}[,pingTimeout=<value>]]
[-runControlDescription={string=<string>|parameter=<string>}] [-controlLogFile=<file>]
[-glitchLogFile=file=<string>[,readbackRmsThreshold=<value>][,controlRmsThreshold=<value>][,rows=<integer>]]
[-CASecurityTest] [-waveforms=<filename>,<type>] [-verbose] [-dryRun]
\end{verbatim}

\item \textbf{files:}
\begin{itemize}
  \item \textbf{input file:} \par
    An SDDS file containing the inverse response matrix. A string column lists actuator PV names and one column for each readback PV provides the matrix elements.
  \item \textbf{output file:} \par
    If given, records readback and actuator values at each correction step.
\end{itemize}

\item \textbf{switches:}
\begin{itemize}
  \item {\tt -searchPath} --- directory path used to locate input files.
  \item {\tt -actuatorColumn} --- string column in the input file naming actuators.
  \item {\tt -gain} --- scalar or PV specifying overall feedback gain.
  \item {\tt -interval} --- time between corrections.
  \item {\tt -steps} --- number of correction iterations.
  \item {\tt -updateInterval} --- steps between output file updates.
  \item {\tt -average} --- number of readback acquisitions to average, optionally with a time interval.
  \item {\tt -testValues} --- SDDS file giving limits that suspend feedback when readbacks are out of range.
  \item {\tt -deltaLimit} --- maximum change permitted for any actuator.
  \item {\tt -readbackLimit} --- maximum allowed readback error for each PV.
  \item {\tt -actionLimit} --- minimum absolute readback before applying corrections.
  \item {\tt -despike} --- despike readback data using neighbors and threshold tests.
  \item {\tt -runControlPV} --- run control PV name or parameter.
  \item {\tt -runControlDescription} --- run control description parameter.
  \item {\tt -controlLogFile} --- write actuator changes to a log file.
  \item {\tt -glitchLogFile} --- log data when RMS thresholds are exceeded.
  \item {\tt -CASecurityTest} --- verify write access to control PVs.
  \item {\tt -waveforms} --- specify waveform PVs to read or write in addition to scalars.
  \item {\tt -verbose} --- print extra information.
  \item {\tt -dryRun} --- compute corrections without writing to actuators.
\end{itemize}

\item \textbf{see also:}
\begin{itemize}
  \item \progref{sddscontrollaw}
\end{itemize}

\item \textbf{author:} Louis Emery, Hairong Shang, Robert Soliday, ANL/APS.
\end{sddsprog}
